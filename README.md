# MILUINO
## Мои страдания (ну не очень) с отечественными мк.
### Акт 1: Обновление прошивки программатора.
Платформой для отладки я избрал плату от АО "НПО КАДЕТЕК" - MILUINO на базе MDR1211FI (aka К1986ВЕ92FI).
В качестве программатора-отладчика на ней стоит STlink V2 на базе чипа STM32F103CBT6. Прошивка в нем ожидаемо не актуальная и среды на неё ругаются. Обновить ее стандартными методами не удается (почему я так и не выяснил, возможно в схеме самой платы есть ошибка - утверждать не берусь).
Итак вот алгоритм прошивки прогромматора до актуальной версии (на момент написания - 46) найденный мной:
1. Стереть утилитой STMFlashLoader  Demo через uart (есть на сайте ST). !ВАЖНО! - поставить перемычку в XP9 и uart подключать в XP5 (около USB) (второй uart разъем идет в миландр).
2. Зашить загрузчик той же утилитой (есть на сайте кадетека под этой [статьей](https://cadetech.ru/node/30) (есть еще на гитхабе NR.electronics).
3. Скачать с сайта ST программу stsw-link007.
4. Перейти в директорию AllPlatforms.
5. Запустить STLinkUpgrade.jar из консоли с аргументами [отсюда]( https://github.com/blackmagic-debug/blackmagic/blob/main/src/platforms/stlink/README.md) (в конечном итоге я использовал этот вариант: ```java -jar STLinkUpgrade.jar -msvcp -force_prog```, но работают все для стлинк 2 и 2.1 я проверял)
6. Программа прошьет стлинк и кинет ошибку.
  
   ![](img/error.jpg)
7. Переподключаем плату - готово прошивка обновлена.

   ![](img/cubeprog_fw_version.png)
